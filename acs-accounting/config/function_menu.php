<?php$path = realpath(dirname(__FILE__). '/../');include $path.'/database.php';if (!function_exists('__menu_list')) {    function __menu_list(){        $db = new database();                   $sql = "SELECT * FROM  menu_tb WHERE  menu_status=1 ORDER BY menu_sort ASC";        $result = $db->query($sql)->result();                $arrMenuData = array();        $arrMenuName = array();        $arrMenuList = array();        $n = 1;        if(count($result)>=1){            foreach ($result as $row) {                $menu_id = $row["menu_id"];                $menu_name = $row["menu_name"];                $menu_type = $row["menu_type"];                $menu_sort = $row["menu_sort"];                $menu_status = $row["menu_status"];                $menu_show = $row["menu_show"];                $menu_file = $row["menu_file"];                $menu_parent_id = $row["menu_parent_id"];                                    $arrMenuName[$menu_id] = $menu_name;                $arrMenuData[$menu_id] = $row;                                if($menu_type=="page"){                    if($menu_parent_id==0){                    }else{                        $arrMenuList[$menu_id][$menu_parent_id] =  $menu_name;                    }                }else if($menu_type=="dropdown"){                    if($menu_parent_id==0){                    }else{                        $arrMenuList[$menu_id][$menu_parent_id] =  $menu_name;                    }                }                                                $n++;            }        }                                $arrMenuSort1= array();        $arrMenuSort2= array();        $arrMenuSort3= array();                $arrMenu = array();        $arrMenu2 = array();                $n = 1;        if(count($result)>=1){            foreach ($result as $row) {                $menu_id = $row["menu_id"];                $menu_name = $row["menu_name"];                $menu_type = $row["menu_type"];                $menu_sort = $row["menu_sort"];                $menu_status = $row["menu_status"];                $menu_file = $row["menu_file"];                $menu_parent_id = $row["menu_parent_id"];                                $list1 = array();                   $list2= array();                    if($menu_type=="page"){                    if($menu_parent_id==0){                        $arrMenu[$menu_id]["data"] = $row;                        $arrMenuSort1[$menu_id] = $menu_sort;//1                    }else{                        if(isset($arrMenuList[$menu_parent_id])){                            $key_parent = array_keys($arrMenuList[$menu_parent_id]);                            $key_parent = $key_parent[0];                            $arrMenu2[$menu_parent_id][$key_parent][$menu_id] = array("data"=>$row);                        }else{                            $arrMenu[$menu_parent_id]["list"][$menu_id] =array("data"=>$row);                            $arrMenuSort2[$menu_parent_id][$menu_id] = $menu_sort;//2                        }                    }                }else if($menu_type=="dropdown"){                    if($menu_parent_id==0){                        $arrMenu[$menu_id]["data"] = $row;                        $arrMenuSort1[$menu_id] = $menu_sort;//1                    }else{                        if(isset($arrMenuList[$menu_parent_id])){                        }else{                            $arrMenu[$menu_parent_id]["list"][$menu_id] = array("data"=>$row);//2                            $arrMenuSort2[$menu_parent_id][$menu_id] = $menu_sort;//2                        }                    }                }                                $n++;            }        }                if(!empty($arrMenu2)){            foreach ($arrMenu2 as $keyMenu2 => $valMenu2) {                $key_parent = array_keys($valMenu2);                $key_parent = $key_parent[0];                                $arr = array();                if(!empty($valMenu2)){                    foreach ($valMenu2 as $keyMenu3 => $valMenu3) {                        $arrMenu[$keyMenu3]["list"][$keyMenu2]["list"] = $valMenu3;//3                                                if(!empty($valMenu3)){                            foreach ($valMenu3 as $keyMenu4 => $valMenu4) {                                $arrMenuSort3[$keyMenu3][$keyMenu2][$keyMenu4] = $valMenu4["data"]["menu_sort"];                            }                        }                    }                }            }        }                $arrMenuSort1 = __sort_array_keepkey($arrMenuSort1);        $arrMenuSort2 = __sort_array_keepkey($arrMenuSort2);        $arrMenuSort3 = __sort_array_keepkey($arrMenuSort3);        return array("arrayManu"=>$arrMenu,"arraySort1"=>$arrMenuSort1,"arraySort2"=>$arrMenuSort2,"arraySort3"=>$arrMenuSort3,"arrayMenuData"=>$arrMenuData);    }}if (!function_exists('__menu_user_style')) {    function __menu_user_style(){        $session_user_level_id = __session_user("level_id");                if($session_user_level_id==2){            $array = array(                "1" => array("bg"=>"#FFD812","css"=>'ul.navbar-nav > li > a {   color: #000!important;}ul.navbar-nav > li:hover > a, ul.navbar-nav > li.active > a {color: #00F!important;}.dropdown-menu {border-top: 2px solid #00F!important;}'),                "2" => array("bg"=>"#e92f83","css"=>'ul.navbar-nav > li:hover > a, ul.navbar-nav > li.active > a {color: #00F!important;}.dropdown-menu {border-top: 2px solid #D4166C!important;}'),                "3" => array("bg"=>"#2ECC71","css"=>""),                "4" => array("bg"=>"#D45C00","css"=>'ul.navbar-nav > li:hover > a, ul.navbar-nav > li.active > a {color: #00F!important;}.dropdown-menu {border-top: 2px solid #803700!important;}'),                "5" => array("bg"=>"#15cbd0","css"=>""),                "6" => array("bg"=>"#B014FF","css"=>""),                "7" => array("bg"=>"#E40505","css"=>""),            );                        $today_nunber = date('N', strtotime(date("Y-m-d")));                        return $array[$today_nunber];        }            }}if (!function_exists('__menu_list_page')) {    function __menu_list_page(){        $db = new database();           $sql_menu = "SELECT * FROM menu_tb WHERE menu_type='page'";        $result_menu = $db->query($sql_menu)->result();                $array= array();        if(count($result_menu)>=1){            foreach ($result_menu as $row_menu) {                $menu_id = $row_menu["menu_id"];                $array[$menu_id] = $menu_id;            }        }                return $array;    }}if (!function_exists('__menu_list_access_company')) {    function __menu_list_access_company($company_id=""){                $arrAccess = array();        $db = new database();           $sql = "SELECT mc.* FROM menu_access_company_tb mc        LEFT JOIN menu_tb m ON m.menu_id = mc.menu_id        WHERE ( mc.comp_id ='".$company_id."' AND m.menu_check_company = 'Y') OR (m.menu_check_company = 'N')";                $result = $db->query($sql)->result();        $arrAccess = array();        if(count($result)>=1){            foreach ($result as $row) {                $arrAccess[$row["menu_id"]] = $row["acc_comp_id"];            }        }                return $arrAccess;    }}if (!function_exists('__menu_list_access_level')) {    function __menu_list_access_level($level_id=""){        $arrAccess = array();        if($level_id!=""){            $db = new database();               $sql = "SELECT * FROM menu_access_level_tb WHERE level_id ='".$level_id."' ";            $result = $db->query($sql)->result();            $arrAccess = array();            if(count($result)>=1){                foreach ($result as $row) {                    $arrAccess[$row["menu_id"]] = $row["acc_level_id"];                }            }        }                return $arrAccess;    }}if (!function_exists('__menu_list_access_user')) {    function __menu_list_access_user($user_id=""){        $arrAccess = array();        if($user_id!=""){            $db = new database();               $sql = "SELECT * FROM menu_access_user_tb WHERE user_id ='".$user_id."' ";            $result = $db->query($sql)->result();                        $arrAccess = array();            if(!empty($result)){                foreach ($result as $row) {                    $arrAccess[$row["menu_id"]] = $row["acc_user_id"];                }            }        }                return $arrAccess;    }}if (!function_exists('__menu_check_access')) {    function __menu_check_access($menu_id=0,$menu_type="",$arrAccess=array(),$arrMenuInParent=array()){        $check = 0;                if($menu_type=="page"){            if(!empty($arrAccess[$menu_id])){                $check = 1;            }        }else if($menu_type=="dropdown"){            if(!empty($arrAccess) && !empty($arrMenuInParent)){                $result=array_intersect_key($arrMenuInParent,$arrAccess);                if(count($result)>=1){                    $check = 1;                }            }        }                        return $check;    }}if (!function_exists('__menu_check_access_company')) {    function __menu_check_access_company($menu_id=0,$menu_type="",$arrAccess=array()){        $access_comp = 0;        if($menu_type=="page"){            if(isset($arrAccess[$menu_id])){                $access_comp = 1;            }        }else if($menu_type=="dropdown"){                    }                return $access_comp;    }}if (!function_exists('__menu_navbar')) {    function __menu_navbar($comp_id="",$level_id="",$user_id=""){        $file_current1 = basename($_SERVER["SCRIPT_FILENAME"], '.php');        $file_current = $file_current1.".php";                //parameter url         $paramurl_company_id = (isset($_GET["cid"])) ?$_GET["cid"] : 0;        $paramurl_department_id = (isset($_GET["dep"])) ?$_GET["dep"] : 0;        $url_para_full = "?cid=".$paramurl_company_id."&dep=".$paramurl_department_id;        //$url_para_comp = "?cid=".$paramurl_company_id;        $url_para_dep = "?dep=".$paramurl_department_id;        $url_para_comp = $url_para_full;        $url_para_comp_depnone= "?cid=".$paramurl_company_id."&dep=0";                $arrMenuList = __menu_list();        $arrMenu = $arrMenuList["arrayManu"];        $arrMenuSort1 = $arrMenuList["arraySort1"];        $arrMenuSort2 = $arrMenuList["arraySort2"];        $arrMenuSort3 = $arrMenuList["arraySort3"];        $arrMenuData = $arrMenuList["arrayMenuData"];                $arrAccessCompany = __menu_list_access_company($comp_id);        $arrAccessLevel = __menu_list_access_level($level_id);        $arrAccessUser = __menu_list_access_user($user_id);                $arrAccesslLevelUser=$arrAccessLevel+$arrAccessUser;        $arrAccess = array_intersect_key($arrAccessCompany, $arrAccesslLevelUser);                $id_active = "";        $id_active_null = "";        $n=1;        $html = "";                $arrPageAll = array();        if(!empty($arrMenuSort1)){            foreach ($arrMenuSort1 as $keyMenu => $valMenu) {                $valMenuData = $arrMenuData[$keyMenu];                $menu_id = $valMenuData["menu_id"];                $menu_name = $valMenuData["menu_name"];                $menu_type = $valMenuData["menu_type"];                $menu_sort = $valMenuData["menu_sort"];                $menu_show = $valMenuData["menu_show"];                $menu_status = $valMenuData["menu_status"];                $menu_file = $valMenuData["menu_file"];                $menu_parent_id = $valMenuData["menu_parent_id"];                $menu_remark = $valMenuData["menu_remark"];                $menu_check_company1 = $valMenuData["menu_check_company"];                $menu_check_department1 = $valMenuData["menu_check_department"];                $menu_check_seldep1 = $valMenuData["menu_check_seldep"];                                $arrMenuInParent1 = (!empty($arrMenuSort2[$menu_id])) ? $arrMenuSort2[$menu_id] : array();                                $check_page1 = ($menu_type=="page") ? 1 : 0;                $count_page_inparent1 = $check_page1;                                $check_access1 = __menu_check_access($menu_id,$menu_type,$arrAccess,$arrMenuInParent1);                $count_access_inparent1 = $check_access1;                                $show_manu1 = ( ($menu_type=="page" && $check_access1) || ($menu_type=="dropdown" && count($arrMenuInParent1) >=1)) ? 1 : 0 ;                $count_show_inparent1 = $show_manu1;                                $check_active1 =  ($file_current==$menu_file && $check_page1 && $check_access1) ? 1 : 0;                $count_active_inparent1 = $check_active1;                                if($file_current==$menu_file && $check_page1 && $check_access1){                    $id_active = $menu_id;                }                                $href_file_manu1 = $menu_file;                if($menu_check_company1=="Y"){                    if($menu_check_seldep1=="N"){                        $href_file_manu1 .= $url_para_comp;                    }else{                        $href_file_manu1 .=$url_para_comp_depnone;                    }                }else if($menu_check_company1=="N"){                    $href_file_manu1 .= ($menu_check_department1=="Y") ? $url_para_dep : "";                }                                if($check_page1){                    $arrPageAll[$menu_file] = $menu_file;                }                                                        $n2 = 1;                $html2= "";                if(!empty($arrMenuInParent1)){                    foreach ($arrMenuInParent1 as $keyMenu2 => $valMenu2) {                        $valMenuData2 = $arrMenuData[$keyMenu2];                        $menu_id2 = $valMenuData2["menu_id"];                        $menu_name2 = $valMenuData2["menu_name"];                        $menu_type2 = $valMenuData2["menu_type"];                        $menu_sort2 = $valMenuData2["menu_sort"];                        $menu_show2 = $valMenuData2["menu_show"];                        $menu_status2 = $valMenuData2["menu_status"];                        $menu_file2 = $valMenuData2["menu_file"];                        $menu_parent_id2 = $valMenuData2["menu_parent_id"];                        $menu_remark2 = $valMenuData2["menu_remark"];                        $menu_check_company2 = $valMenuData2["menu_check_company"];                        $menu_check_department2 = $valMenuData2["menu_check_department"];                        $arrMenuInParent2 = (!empty($arrMenuSort3[$menu_id][$menu_id2])) ? $arrMenuSort3[$menu_id][$menu_id2] : array();                        $menu_check_seldep2 = $valMenuData2["menu_check_seldep"];                                        $check_page2 = ($menu_type2=="page") ? 1 : 0;                        $count_page_inparent1 += $check_page2;                        $count_page_inparent2 = $check_page2;                                                $check_access2 = __menu_check_access($menu_id2,$menu_type2,$arrAccess,$arrMenuInParent2);                        $count_access_inparent1 += $check_access2;                        $count_access_inparent2 = $check_access2;                                                $show_manu2 = ( ($menu_type2=="page" && $check_access2) || ($menu_type2=="dropdown" && count($arrMenuInParent2) >=1)) ? 1 : 0 ;                        $count_show_inparent1 += $show_manu2;                        $count_show_inparent2 = $show_manu2;                                                $check_active2 =  ($file_current==$menu_file2 && $check_page2 && $check_access2) ? 1 : 0;                        $count_active_inparent1 += $check_active2;                        $count_active_inparent2 = $check_active2;                                                if($file_current==$menu_file2 && $check_page2 && $check_access2){                            $id_active = $menu_id2;                        }                                                $href_file_manu2 = $menu_file2;                        if($menu_check_company2=="Y"){                            if($menu_check_seldep2=="N"){                                $href_file_manu2 .= $url_para_comp;                            }else{                                $href_file_manu2 .=$url_para_comp_depnone;                            }                        }else if($menu_check_company2=="N"){                            $href_file_manu2 .= ($menu_check_department2=="Y") ? $url_para_dep : "";                        }                                    if($check_page2){                            $arrPageAll[$menu_file2] = $menu_file2;                        }                                                    $n3 = 1;                        $html3= "";                        if(!empty($arrMenuInParent2)){                            foreach ($arrMenuInParent2 as $keyMenu3 => $valMenu3) {                                $valMenuData3 = $arrMenuData[$keyMenu3];                                $menu_id3 = $valMenuData3["menu_id"];                                $menu_name3 = $valMenuData3["menu_name"];                                $menu_type3 = $valMenuData3["menu_type"];                                $menu_sort3 = $valMenuData3["menu_sort"];                                $menu_show3 = $valMenuData3["menu_show"];                                $menu_status3 = $valMenuData3["menu_status"];                                $menu_file3 = $valMenuData3["menu_file"];                                $menu_parent_id3 = $valMenuData3["menu_parent_id"];                                $menu_remark3 = $valMenuData3["menu_remark"];                                $menu_check_company3 = $valMenuData3["menu_check_company"];                                $menu_check_department3 = $valMenuData3["menu_check_department"];                                $menu_check_seldep3 = $valMenuData3["menu_check_seldep"];                                                        $check_page3 = ($menu_type3=="page") ? 1 : 0;                                $count_page_inparent1 += $check_page3;                                $count_page_inparent2 += $check_page3;                                                                $check_access3 = __menu_check_access($menu_id3,$menu_type3,$arrAccess);                                $count_access_inparent1 += $check_access3;                                $count_access_inparent2 += $check_access3;                                                                $show_manu3 = ($menu_type3=="page" && $check_access3) ? 1 : 0;                                $count_show_inparent1 += $show_manu3;                                $count_show_inparent2 += $show_manu3;                                                                $check_active3 =  ($file_current==$menu_file3 && $check_access3) ? 1 : 0;                                $count_active_inparent1 += $check_active3;                                $count_active_inparent2 += $check_active3;                                                                $file_active3 =  ($file_current==$menu_file3 && $check_page3) ? $menu_file3 : "'";                                                                if($file_current==$menu_file3 && $check_page3  && $check_access3){                                    $id_active = $menu_id3;                                }                                                                                            $class_active3 = ($check_active3) ? "active3": "";                                                                if($check_page3){                                    $arrPageAll[$menu_file3] = $menu_file3;                                }                                                                $href_file_manu3 = $menu_file3;                                if($menu_check_company3=="Y"){                                    if($menu_check_seldep3=="N"){                                        $href_file_manu3 .= $url_para_comp;                                    }else{                                        $href_file_manu3 .=$url_para_comp_depnone;                                    }                                }else if($menu_check_company3=="N"){                                    $href_file_manu3 .= ($menu_check_department3=="Y") ? $url_para_dep : "";                                }                                                                if($menu_show3==1){                                    if($show_manu3 && $check_access3){                                        $html3.= '<li class="nav-level-1 '.$class_active3.'">';                                            $html3.= '<a href="'.$href_file_manu3.'">';                                                $html3.= $menu_name3;                                            $html3.= '</a>';                                        $html3.= '</li>';                                    }                                }                                                                            $n3++;                              }                        }                                                    $class_active2 = ($count_active_inparent2>=1) ? "active2": "";                        if($menu_show2==1){                            if($show_manu2  && $count_access_inparent2>=1){                                if($menu_type2=="page"){                                    $html2.= '<li class="nav-level-2 '.$class_active2.'">';                                        $html2.= '<a  href="'.$href_file_manu2.'">';                                            $html2.= $menu_name2;                                        $html2.= '</a>';                                    $html2.= '</li>';                                                                    }else if($menu_type2=="dropdown"){                                    if($count_access_inparent2>1){                                        $html2.= '<li class="nav-level-2 dropdown-submenu  '.$class_active2.'"">';                                            $html2.= '<a href="#!" class="dropdown-toggle" data-toggle="dropdown">';                                                $html2.= $menu_name2;                                            $html2.= '</a>';                                            $html2.= '<ul class="dropdown-menu">';                                                $html2.= $html3;                                            $html2.= '</ul>';                                        $html2.= '</li>';                                    }                                }                            }                        }                                                    $n2++;                    }                }                                                $class_active1 = ($count_active_inparent1>=1) ? "active1": "";                $html1 = "";                if($menu_show==1){                    if($show_manu1 && $count_access_inparent1>=1){                        if($menu_type=="page"){                            $html1.= '<li class="nav-level-1 nav-item '.$class_active1.'">';                                $html1.= '<a class="nav-link" href="'.$href_file_manu1.'">';                                    $html1.= $menu_name;                                $html1.= '</a>';                            $html1.= '</li>';                        }else if($menu_type=="dropdown"){                            if($count_access_inparent1>1){                                $html1.= '<li class="nav-level-1 nav-item dropdown '.$class_active1.'">';                                    $html1.= '<a href="#!" class="nav-link dropdown-toggle" data-toggle="dropdown">';                                        $html1.= $menu_name;                                        $html1.= '&nbsp;<i class="icofont-rounded-down"></i>';                                    $html1.= '</a>';                                                                        $html1.= '<ul class="dropdown-menu" role="menu">';                                        $html1.= $html2;                                    $html1.= '</ul>';                                $html1.= '</li>';                            }                        }                    }                }                        $html .= $html1;                                                $n++;                   }        }                                            $check_company = false;        $text_company = "";        $check_department = false;        $text_department = "";        $company_name = "";        $department_name = "";        $menu_check_company = "";        $menu_check_department = "";                if(empty($arrPageAll[$file_current])){            $paramurl_company_id = (isset($_GET["cid"])) ?$_GET["cid"] : 0;            $paramurl_department_id = (isset($_GET["dep"])) ?$_GET["dep"] : 0;                         if(isset($_GET["cid"])){                 if($paramurl_company_id!="" && $paramurl_company_id!="0"){                    $menu_check_company = "Y" ;                    $data_company = __data_company($paramurl_company_id,"id");                    if(!empty($data_company)){                        $company_name = __data_company($paramurl_company_id,"name");                        $check_company = true;                    }else{                        $text_company = "ไม่พบบริษัทที่ระบุ";                        $text_company .= '<br><br> <center><a class="btn btn-lg btn-primary" href="index_selcomp.php">เลือกบริษัท</a></center>';                    }                 }else{                    $menu_check_company = "N" ;                    $check_company = true;                 }             }else{                $menu_check_company = "N" ;                $check_company = true;             }                                     if(isset($_GET["dep"])){                 if($paramurl_department_id!="" && $paramurl_department_id!="0"){                    $menu_check_department = "N" ;                    $data_department = __data_department($paramurl_department_id,"id");                     $data_department_compid = __data_department($paramurl_department_id,"company_id");                    if(!empty($data_department)){                        if($paramurl_company_id==$data_department_compid){                            $dep_list = __authority_department_list($user_id,$data_department_compid);                            $department_name = __data_department($paramurl_department_id,"name");                            $check_department = true;                        }else{                            $text_department = "แผนกที่ระบุไม่ตรงกับบริษัทที่ระบุ";                        }                    }else{                        $text_department = "ไม่พบแผนกที่ระบุ";                    }                 }else{                    $menu_check_department = "N" ;                    $check_department = true;                 }             }else{                $menu_check_department = "N" ;                $check_department = true;             }        }else{            if(!empty($arrMenuData[$id_active])){                $paramurl_company_id = (isset($_GET["cid"])) ?$_GET["cid"] : 0;                $paramurl_department_id = (isset($_GET["dep"])) ?$_GET["dep"] : 0;                    $arrActiveManu = $arrMenuData[$id_active];                $menu_check_company = $arrActiveManu["menu_check_company"];                $menu_check_department = $arrActiveManu["menu_check_department"];                                if($menu_check_company=="Y"){                    if(!empty($_GET["cid"])){                        $data_company = __data_company($paramurl_company_id,"id");                            if(!empty($data_company)){                                                                if(!empty($arrAccessCompany)){                                    $company_list = __authority_company_list($user_id);                                                                        if(!empty($company_list[$paramurl_company_id])){                                        $company_name = __data_company($paramurl_company_id,"name");                                        $check_company = true;                                    }else{                                        $text_company = "คุณไม่มีสิทธิ์เข้าถึงบริษัทนี้";                                        $text_company .= ' <br><br><center><a class="btn btn-lg btn-primary" href="index_selcomp.php">เลือกบริษัท</a></center>';                                    }                                }else{                                    $text_company = "บริษัทที่ระบุ ไม่สามารถเข้าถึงหน้านี้ได้";                                    $text_company .= '<br><br> <center><a class="btn btn-lg btn-primary" href="index_selcomp.php">เลือกบริษัท</a></center>';                                }                            }else{                                $text_company = "ไม่พบบริษัทที่ระบุ";                                $text_company .= '<br><br> <center><a class="btn btn-lg btn-primary" href="index_selcomp.php">เลือกบริษัท</a></center>';                            }                    }else{                        $text_company = "กรุณาระบุบริษัท";                        $text_company .= ' <br><br><center><a class="btn btn-lg btn-primary" href="index_selcomp.php">เลือกบริษัท</a></center>';                    }                }else if($menu_check_company=="N"){                    $check_company = true;                }else{                    $text_department = "คุณไม่มีสิทธิ์เข้าถึงหน้านี้";                }                                if($menu_check_department=="Y"){                    if(!empty($_GET["dep"])){                            $data_department = __data_department($paramurl_department_id,"id");                           $data_department_compid = __data_department($paramurl_department_id,"company_id");                            if(!empty($data_department)){                                if($paramurl_company_id==$data_department_compid){                                    $dep_list = __authority_department_list($user_id,$data_department_compid);                                    if(!empty($dep_list[$paramurl_department_id])){                                        $department_name = __data_department($paramurl_department_id,"name");                                        $check_department = true;                                    }else{                                        $text_department = "คุณไม่มีสิทธิ์เข้าถึงแผนกนี้";                                    }                                }else{                                    $text_department = "แผนกที่ระบุไม่ตรงกับบริษัทที่ระบุ";                                }                            }else{                                $text_department = "ไม่พบแผนกที่ระบุ";                            }                    }else{                        $text_department = "กรุณาระบุแผนก";                    }                }else if($menu_check_department=="N"){                    $check_department = true;                }            }else{                $text_company = "ไม่พบบริษัทที่ระบุ";                $text_department = "ไม่พบแผนกที่ระบุ";            }        }        $ck_all = false;        $text_error_all = "";        if($menu_check_company=="Y"){            if($check_company){                if($menu_check_department=="Y"){                    if($check_department){                        $ck_all = true;                    }else{                        $text_error_all = $text_department;                    }                   }else{                    if($menu_check_department=="N"){                        if(!empty($_GET["dep"])){                            $data_department = __data_department($paramurl_department_id,"id");                            $data_department_compid = __data_department($paramurl_department_id,"company_id");                            if(!empty($data_department)){                                if($paramurl_company_id==$data_department_compid){                                    $ck_all = true;                                }else{                                    $text_error_all = "แผนกที่ระบุไม่ตรงกับบริษัทที่ระบุ";                                }                            }else{                                $text_error_all = "ไม่พบแผนกที่ระบุ";                            }                        }else{                            $ck_all = true;                        }                    }else{                        $ck_all = true;                    }                }            }else{                $text_error_all = $text_company;            }        }else if($menu_check_company=="N"){            $ck_all = true;        }else{            $text_error_all = "ข้อมูลผิดพลาด กรุณาเลือกบริษัทใหม่อีกครั้ง";            $text_error_all .= ' <br><br><center><a class="btn btn-lg btn-primary" href="index_selcomp.php">เลือกบริษัท</a></center>';        }                $arr = array(            "html"=>$html,            "menu_check_company" => $menu_check_company,            "check_company" => $check_company,            "text_company" => $text_company,                        "check_department" => $check_department,            "menu_check_department" => $menu_check_department,            "text_department" => $text_department,                        "company_name" => $company_name,            "department_name" => $department_name,                        "ck_all" => $ck_all,            "text_error_all" => $text_error_all,        );                        return $arr;    }}?>